{"cells":[{"cell_type":"markdown","source":["#Dependecies"],"metadata":{"id":"hs7bqlcQTzjR"}},{"cell_type":"code","execution_count":1,"metadata":{"id":"li1DzXX-NOfL","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1651037176073,"user_tz":-120,"elapsed":30510,"user":{"displayName":"Troels Jensen","userId":"10952173865704385677"}},"outputId":"fdf7e2f7-b41f-4b3c-a8e1-4d6a90baecf0"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting transformers\n","  Downloading transformers-4.18.0-py3-none-any.whl (4.0 MB)\n","\u001b[K     |████████████████████████████████| 4.0 MB 12.0 MB/s \n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.64.0)\n","Collecting huggingface-hub<1.0,>=0.1.0\n","  Downloading huggingface_hub-0.5.1-py3-none-any.whl (77 kB)\n","\u001b[K     |████████████████████████████████| 77 kB 6.0 MB/s \n","\u001b[?25hCollecting pyyaml>=5.1\n","  Downloading PyYAML-6.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (596 kB)\n","\u001b[K     |████████████████████████████████| 596 kB 47.5 MB/s \n","\u001b[?25hCollecting tokenizers!=0.11.3,<0.13,>=0.11.1\n","  Downloading tokenizers-0.12.1-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (6.6 MB)\n","\u001b[K     |████████████████████████████████| 6.6 MB 41.3 MB/s \n","\u001b[?25hRequirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.11.3)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.6.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Collecting sacremoses\n","  Downloading sacremoses-0.0.49-py3-none-any.whl (895 kB)\n","\u001b[K     |████████████████████████████████| 895 kB 41.0 MB/s \n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.1.0->transformers) (4.2.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.8)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.8.0)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2021.10.8)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.15.0)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.1.0)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (7.1.2)\n","Installing collected packages: pyyaml, tokenizers, sacremoses, huggingface-hub, transformers\n","  Attempting uninstall: pyyaml\n","    Found existing installation: PyYAML 3.13\n","    Uninstalling PyYAML-3.13:\n","      Successfully uninstalled PyYAML-3.13\n","Successfully installed huggingface-hub-0.5.1 pyyaml-6.0 sacremoses-0.0.49 tokenizers-0.12.1 transformers-4.18.0\n","Collecting trl\n","  Downloading trl-0.0.3-py3-none-any.whl (15 kB)\n","Collecting transformers==4.3.2\n","  Downloading transformers-4.3.2-py3-none-any.whl (1.8 MB)\n","\u001b[K     |████████████████████████████████| 1.8 MB 10.8 MB/s \n","\u001b[?25hRequirement already satisfied: torch>=1.4.0 in /usr/local/lib/python3.7/dist-packages (from trl) (1.11.0+cu113)\n","Requirement already satisfied: numpy>=1.18.2 in /usr/local/lib/python3.7/dist-packages (from trl) (1.21.6)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers==4.3.2->trl) (4.64.0)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers==4.3.2->trl) (4.11.3)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers==4.3.2->trl) (2019.12.20)\n","Requirement already satisfied: sacremoses in /usr/local/lib/python3.7/dist-packages (from transformers==4.3.2->trl) (0.0.49)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from transformers==4.3.2->trl) (21.3)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers==4.3.2->trl) (3.6.0)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers==4.3.2->trl) (2.23.0)\n","Collecting tokenizers<0.11,>=0.10.1\n","  Downloading tokenizers-0.10.3-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (3.3 MB)\n","\u001b[K     |████████████████████████████████| 3.3 MB 10.9 MB/s \n","\u001b[?25hRequirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch>=1.4.0->trl) (4.2.0)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers==4.3.2->trl) (3.8.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->transformers==4.3.2->trl) (3.0.8)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.3.2->trl) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.3.2->trl) (1.24.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.3.2->trl) (2021.10.8)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.3.2->trl) (3.0.4)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers==4.3.2->trl) (7.1.2)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers==4.3.2->trl) (1.1.0)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers==4.3.2->trl) (1.15.0)\n","Installing collected packages: tokenizers, transformers, trl\n","  Attempting uninstall: tokenizers\n","    Found existing installation: tokenizers 0.12.1\n","    Uninstalling tokenizers-0.12.1:\n","      Successfully uninstalled tokenizers-0.12.1\n","  Attempting uninstall: transformers\n","    Found existing installation: transformers 4.18.0\n","    Uninstalling transformers-4.18.0:\n","      Successfully uninstalled transformers-4.18.0\n","Successfully installed tokenizers-0.10.3 transformers-4.3.2 trl-0.0.3\n"]}],"source":["!pip install transformers\n","!pip install trl"]},{"cell_type":"code","source":["import pandas as pd\n","import torch\n","import itertools\n","import torch.nn.functional as F\n","from transformers import TrainingArguments, Trainer, AutoModelForCausalLM, AutoTokenizer, top_k_top_p_filtering\n","from trl.gpt2 import GPT2HeadWithValueModel\n","from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0E6Ms0QUTqY2","executionInfo":{"status":"ok","timestamp":1651037207384,"user_tz":-120,"elapsed":31328,"user":{"displayName":"Troels Jensen","userId":"10952173865704385677"}},"outputId":"7a777b8c-79cc-43f5-b7f6-783fe7a18d15"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"markdown","source":["#Sampling functions"],"metadata":{"id":"W1hntA-VT5Xf"}},{"cell_type":"code","source":["num_prompts = 1200\n","prompt_len = 3\n","\n","min_length = 20\n","max_len = 35\n","k = 0\n","p = 0.95\n","temp = 0.7\n","repetition_penalty = 1.5"],"metadata":{"id":"E5m21QXMz1PB","executionInfo":{"status":"ok","timestamp":1651037813870,"user_tz":-120,"elapsed":420,"user":{"displayName":"Troels Jensen","userId":"10952173865704385677"}}},"execution_count":14,"outputs":[]},{"cell_type":"code","source":["def respond_to_batch(model, queries, txt_len=max_len, min_length=min_length, top_k=k, top_p=p, temperature=temp):\n","    input_ids = queries\n","    eos_token_id = tokenizer_1.eos_token_id\n","\n","    for i in range(txt_len):\n","        outputs = model(input_ids)\n","        next_token_logits = outputs[0][:, -1, :] / temperature\n","        if eos_token_id is not None and i < min_length:\n","          next_token_logits[:, eos_token_id] = -float(\"inf\")\n","        if repetition_penalty != 0:\n","                for i in range(bs): \n","                    for previous_token in set(input_ids[i].tolist()):\n","                        if next_token_logits[i, previous_token] < 0:\n","                            next_token_logits[i, previous_token] *= repetition_penalty\n","                        else:\n","                            next_token_logits[i, previous_token] /= repetition_penalty\n","        next_token_logits = top_k_top_p_filtering(next_token_logits, top_k=top_k, top_p=top_p)\n","        probs = F.softmax(next_token_logits, dim=-1)\n","        next_token = torch.multinomial(probs, num_samples=1).squeeze(1)\n","        input_ids = torch.cat([input_ids, next_token.unsqueeze(-1)], dim=-1)\n","\n","    return input_ids[:, -txt_len:]"],"metadata":{"id":"UnHLbBEJic3i","executionInfo":{"status":"ok","timestamp":1651037816933,"user_tz":-120,"elapsed":325,"user":{"displayName":"Troels Jensen","userId":"10952173865704385677"}}},"execution_count":15,"outputs":[]},{"cell_type":"markdown","source":["#Load models and tokenizers"],"metadata":{"id":"b2hnFoiMkCKU"}},{"cell_type":"code","execution_count":5,"metadata":{"id":"RlBiqC9ajjKs","executionInfo":{"status":"ok","timestamp":1651037258195,"user_tz":-120,"elapsed":50816,"user":{"displayName":"Troels Jensen","userId":"10952173865704385677"}}},"outputs":[],"source":["device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","\n","tokenizer_1 = AutoTokenizer.from_pretrained('/content/drive/MyDrive/Colab Notebooks/saved_models/SARC_gpt2_prefinetune_4.0')\n","model_1 = AutoModelForCausalLM.from_pretrained('/content/drive/MyDrive/Colab Notebooks/saved_models/SARC_gpt2_prefinetune_4.0', pad_token_id=tokenizer_1.eos_token_id).to(device)\n","tokenizer_2 = AutoTokenizer.from_pretrained('/content/drive/MyDrive/Colab Notebooks/saved_models/SARC_gpt2_PPO_2.1')\n","model_2 = GPT2HeadWithValueModel.from_pretrained('/content/drive/MyDrive/Colab Notebooks/saved_models/SARC_gpt2_PPO_2.1', pad_token_id=tokenizer_2.eos_token_id).to(device)"]},{"cell_type":"markdown","source":["#Load,format and tokenize data"],"metadata":{"id":"6fAlslM9KFmZ"}},{"cell_type":"code","source":["path = \"/content/drive/MyDrive/Colab Notebooks/data/SARC_filtered_40K.csv\"\n","data = pd.read_csv(path).drop(\"Unnamed: 0\", axis = 1)\n","\n","data = data[['comment', 'label']]\n","data = data[data['label'] != 1]\n","df = pd.DataFrame(data['comment'])\n","df['tokens'] = df['comment'].apply(lambda x: tokenizer_1.encode(x, return_tensors=\"pt\").to(device))\n","df['tokens'] = df['tokens'].apply(lambda x: x.squeeze(0)[0:prompt_len])\n","df['prompts'] = df['tokens'].apply(lambda x: tokenizer_1.decode(x, skip_special_tokens=True))"],"metadata":{"id":"oNk1NJ82i_J7","executionInfo":{"status":"ok","timestamp":1651037280829,"user_tz":-120,"elapsed":22649,"user":{"displayName":"Troels Jensen","userId":"10952173865704385677"}}},"execution_count":6,"outputs":[]},{"cell_type":"markdown","source":["#Get responses from both models"],"metadata":{"id":"6WPrLZCilIDQ"}},{"cell_type":"code","source":["#Get batch\n","bs = 60\n","\n","prompts = []\n","conventional = []\n","ppos = []\n","\n","for i in range(int(num_prompts / bs)):\n","    results = dict()\n","    df_batch = pd.DataFrame(df.sample(bs))\n","    query_tensors = torch.stack(df_batch['tokens'].tolist())\n","\n","    #Model responses\n","    p = [df_batch['prompts'].iloc[i] for i in range(bs)]\n","    response_tensors_conv = respond_to_batch(model_1, query_tensors,txt_len=max_len)\n","    conv = [tokenizer_1.decode(response_tensors_conv[i, :]).partition(\"<|endoftext|>\")[0] for i in range(bs)]\n","    response_tensors_ppo = respond_to_batch(model_2, query_tensors, txt_len=max_len)\n","    ppo = [tokenizer_2.decode(response_tensors_ppo[i, :]).partition(\"<|endoftext|>\")[0] for i in range(bs)]\n","    prompts.append(p)\n","    conventional.append(conv)\n","    ppos.append(ppo)\n","\n","responses = dict()\n","responses['Prompts'] = list(itertools.chain.from_iterable(prompts))\n","responses['Conventionally finetuned'] = list(itertools.chain.from_iterable(conventional)) \n","responses['Fine-tuned with PPO'] = list(itertools.chain.from_iterable(ppos))\n","\n","df_responses = pd.DataFrame(responses)\n","df_responses.to_excel('/content/drive/MyDrive/Colab Notebooks/results/SARC_responses_ALL.xlsx')\n","df_responses"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"ZslKAsnIlGfN","executionInfo":{"status":"ok","timestamp":1651038230418,"user_tz":-120,"elapsed":408626,"user":{"displayName":"Troels Jensen","userId":"10952173865704385677"}},"outputId":"35d2b0f1-1b69-4d6c-e35c-d8d95f0bdd9e"},"execution_count":16,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                 Prompts                           Conventionally finetuned  \\\n","0               Or, bust  le and the rush of traffic can cause you to be...   \n","1        Fuck OP posting   about the shitty Fascist flag, I don't care. ...   \n","2     Women, homosexuals   and the rest of us are just as bad. They're r...   \n","3          The door weld  s shut, so we should all be able to drink free...   \n","4               I'd take   a lot of time to get that done, but I'm sure ...   \n","...                  ...                                                ...   \n","1195           TIL there   are 2nd graders in high school and they don't...   \n","1196          you can do   it...but you don't have the energy or speed t...   \n","1197             Well, *  I* am a woman and I've never been raped. That'...   \n","1198             agreed,   I'm sure these idiots will be the next victim...   \n","1199       Go to Atlanta  , but if I'm not spending my time there in the...   \n","\n","                                    Fine-tuned with PPO  \n","0     ing out a bunch of guitars! Ignore the fact th...  \n","1      a picture of themselves in black! What is wro...  \n","2      are the only ones in charge of that group.\\nT...  \n","3     ed to the wall!\\nInstallation by an angry mob....  \n","4      a lot of money out of our pension fund to buy...  \n","...                                                 ...  \n","1195  's not a lot of money you can make in the US. ...  \n","1196   it! Posted by: It's a big deal. If you don't,...  \n","1197  high school is totally okay if you don't have ...  \n","1198   it's totally true that black people are more ...  \n","1199   because they are the only country in Africa w...  \n","\n","[1200 rows x 3 columns]"],"text/html":["\n","  <div id=\"df-c075904e-de32-4c57-a6ff-d74f5eed878a\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Prompts</th>\n","      <th>Conventionally finetuned</th>\n","      <th>Fine-tuned with PPO</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Or, bust</td>\n","      <td>le and the rush of traffic can cause you to be...</td>\n","      <td>ing out a bunch of guitars! Ignore the fact th...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Fuck OP posting</td>\n","      <td>about the shitty Fascist flag, I don't care. ...</td>\n","      <td>a picture of themselves in black! What is wro...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Women, homosexuals</td>\n","      <td>and the rest of us are just as bad. They're r...</td>\n","      <td>are the only ones in charge of that group.\\nT...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>The door weld</td>\n","      <td>s shut, so we should all be able to drink free...</td>\n","      <td>ed to the wall!\\nInstallation by an angry mob....</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>I'd take</td>\n","      <td>a lot of time to get that done, but I'm sure ...</td>\n","      <td>a lot of money out of our pension fund to buy...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>1195</th>\n","      <td>TIL there</td>\n","      <td>are 2nd graders in high school and they don't...</td>\n","      <td>'s not a lot of money you can make in the US. ...</td>\n","    </tr>\n","    <tr>\n","      <th>1196</th>\n","      <td>you can do</td>\n","      <td>it...but you don't have the energy or speed t...</td>\n","      <td>it! Posted by: It's a big deal. If you don't,...</td>\n","    </tr>\n","    <tr>\n","      <th>1197</th>\n","      <td>Well, *</td>\n","      <td>I* am a woman and I've never been raped. That'...</td>\n","      <td>high school is totally okay if you don't have ...</td>\n","    </tr>\n","    <tr>\n","      <th>1198</th>\n","      <td>agreed,</td>\n","      <td>I'm sure these idiots will be the next victim...</td>\n","      <td>it's totally true that black people are more ...</td>\n","    </tr>\n","    <tr>\n","      <th>1199</th>\n","      <td>Go to Atlanta</td>\n","      <td>, but if I'm not spending my time there in the...</td>\n","      <td>because they are the only country in Africa w...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1200 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c075904e-de32-4c57-a6ff-d74f5eed878a')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c075904e-de32-4c57-a6ff-d74f5eed878a button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c075904e-de32-4c57-a6ff-d74f5eed878a');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":16}]},{"cell_type":"code","source":["print(mask3)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bkvhnEkHjv3Y","executionInfo":{"status":"ok","timestamp":1651039232703,"user_tz":-120,"elapsed":13,"user":{"displayName":"Troels Jensen","userId":"10952173865704385677"}},"outputId":"22792cdd-710c-4115-8ce5-7ee0c202a4e1"},"execution_count":29,"outputs":[{"output_type":"stream","name":"stdout","text":["[False, False, False, False, True, False, False, False, False, False, True, False, True, False, False, False, True, False, True, False, False, False, True, True, False, True, False, True, False, False, False, False, False, False, True, False, False, False, True, False, False, False, False, False, True, True, True, True, False, True, False, True, False, False, False, False, True, True, False, False, False, True, False, False, False, False, False, True, False, False, True, True, True, False, False, False, False, False, False, False, False, True, True, True, False, False, False, False, True, False, False, False, False, False, True, False, True, True, False, False, False, True, False, False, False, False, False, False, True, False, False, False, True, True, False, False, False, False, True, False, False, True, False, False, False, True, False, False, False, False, False, False, False, False, False, False, False, True, True, True, True, False, False, False, False, False, False, False, False, False, False, False, False, True, False, False, False, False, True, True, False, False, False, True, False, True, False, False, False, True, False, False, False, False, False, True, False, True, False, False, False, True, False, False, True, False, False, False, False, False, False, False, False, False, True, True, False, True, False, False, False, False, True, False, False, False, False, False, False, False, False, True, False, False, False, True, False, True, False, False, False, True, False, False, True, False, False, True, True, False, False, True, False, False, False, False, False, False, False, False, False, False, False, False, False, True, True, True, False, False, False, True, True, False, False, True, False, False, False, False, False, True, False, True, False, False, True, True, False, True, False, False, False, False, False, False, False, True, True, False, False, False, False, False, False, False, False, False, False, False, True, False, False, True, False, False, False, False, False, False, True, True, False, True, False, True, False, False, False, False, False, False, False, False, False, True, False, True, False, False, True, True, False, False, True, False, False, False, False, False, False, False, False, False, False, False, False, False, True, False, True, False, True, True, False, False, False, False, False, False, False, False, False, False, True, True, False, False, False, False, False, False, True, False, False, False, False, False, False, True, False, False, True, True, False, False, False, False, False, False, False, False, False, True, True, True, True, False, True, False, False, True, False, False, False, False, True, False, True, True, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, True, True, True, False, False, True, True, False, False, True, False, False, True, False, False, False, False, True, True, False, False, True, False, False, True, False, True, False, False, False, False, True, False, True, False, True, False, False, True, False, False, False, False, False, False, False, True, False, False, False, False, True, True, False, True, False, False, False, True, False, False, True, False, False, False, False, False, False, False, False, False, True, False, False, True, False, False, False, False, False, False, False, False, False, True, True, False, True, True, False, False, True, False, False, False, False, False, False, False, False, False, False, False, False, True, True, False, False, False, False, True, False, False, False, False, False, False, False, False, False, True, False, False, True, True, False, False, False, True, False, False, True, False, True, True, True, False, False, False, False, True, False, False, False, False, True, False, False, True, False, False, False, False, False, False, False, True, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, True, False, False, True, True, False, False, False, False, True, True, False, False, True, True, False, False, True, False, True, False, False, False, False, True, False, False, True, False, False, False, True, False, False, False, True, True, False, False, True, True, False, False, False, False, False, False, False, True, False, False, False, False, True, True, False, True, True, True, False, False, False, True, True, False, True, True, True, False, False, True, True, True, True, True, False, False, False, False, False, True, True, False, False, False, False, True, False, True, True, False, False, False, False, False, True, False, False, True, False, False, False, False, True, True, False, True, False, False, False, True, False, False, False, True, False, False, False, False, True, False, False, False, True, False, False, True, False, False, False, True, False, False, False, True, True, False, True, False, True, True, True, False, False, False, True, False, True, True, False, False, False, False, False, False, False, False, True, True, False, False, False, False, True, False, False, False, True, True, False, True, False, False, True, False, True, False, False, False, False, True, False, True, True, False, True, False, False, False, False, True, False, False, True, False, True, False, False, True, False, False, False, False, False, False, True, False, False, False, True, False, False, False, False, True, True, False, True, False, False, False, True, True, True, True, True, True, True, False, True, False, True, False, False, True, False, False, False, False, False, False, True, True, True, False, False, False, False, False, False, False, False, True, True, False, True, False, False, False, False, False, False, True, False, False, False, True, False, False, True, False, False, False, False, False, False, True, True, False, True, False, False, True, False, True, False, True, True, True, True, False, True, True, False, False, False, False, True, False, False, False, False, False, True, True, False, True, False, False, True, False, False, False, False, False, False, False, False, False, False, False, True, False, True, False, False, False, False, False, False, False, False, False, False, True, True, False, True, False, True, False, False, False, False, True, True, False, False, True, False, False, True, False, False, True, False, False, True, False, True, False, False, False, True, False, False, False, False, False, True, True, False, False, False, True, False, False, True, True, False, False, False, False, True, True, False, True, False, True, True, False, True, False, False, True, False, False, True, True, False, False, True, False, False, False, True, True, False, False, False, False, False, True, False, False, False, False, False, False, True, False, False, False, False, False, False, False, False, False, True, True, False, True, False, False, False, False, False, False, False, True, False, False, False, False, True, True, False, True, True, False, False, False, True, False, False, False, True, False, True, True, True, False, False, False, False, False, True, False, False, False, False, True, True, False, False, False, True, False, False, False, False, True, True, False, False, True, True, False, True, False, False, True, False, False, True, False, True, False, True, False, True, False, False, True, False, True, False, False, False, False, True, True, True, True, False, False, True, True, True, False, False, False, False, True, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, True, False, True, True, False, False, False, False, False, False, False, False, False, True, False, False, False, True, True, True, True, False, True, True, True, False, False, False, False, True, True, False, False, True, True, True, True, False, False, False, True, False, True, False, False, True, False, False, False, True, False, True, False, False, True, False, False, False, False, False, False, False, False, True, False, False, False, False, False, False, True]\n"]}]},{"cell_type":"code","source":["filtered_df = df_responses\n","mask1 = [len(i.split()) < (max_len-2) for i in filtered_df['Conventionally finetuned']] \n","mask2 = [len(i.split()) < (max_len-2) for i in filtered_df['Fine-tuned with PPO']]\n","mask3 = [i[-1] == '.' or i[-1] == '?' or i[-1] == '1' for i in filtered_df['Conventionally finetuned']] \n","mask4 = [i[-1] == '.' or i[-1] == '?' or i[-1] == '1' for i in filtered_df['Fine-tuned with PPO']]  \n","filtered_df = df_responses.loc[mask1]\n","filtered_df = df_responses.loc[mask2]\n","filtered_df = df_responses.loc[mask3]\n","filtered_df = df_responses.loc[mask4]\n","print(len(filtered_df))\n","filtered_df.head(25)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1059},"id":"CIBX3gSUhj1S","executionInfo":{"status":"ok","timestamp":1651039211961,"user_tz":-120,"elapsed":524,"user":{"displayName":"Troels Jensen","userId":"10952173865704385677"}},"outputId":"7e5b53d6-ed0e-4e5b-ad4a-922aa2707d2e"},"execution_count":28,"outputs":[{"output_type":"stream","name":"stdout","text":["286\n"]},{"output_type":"execute_result","data":{"text/plain":["                  Prompts                           Conventionally finetuned  \\\n","0                Or, bust  le and the rush of traffic can cause you to be...   \n","2      Women, homosexuals   and the rest of us are just as bad. They're r...   \n","3           The door weld  s shut, so we should all be able to drink free...   \n","4                I'd take   a lot of time to get that done, but I'm sure ...   \n","13        And you believe   this? It's because our government, the public...   \n","15        Today I learned   about the death penalty in high school and it...   \n","18           The irony is   that the Israeli military has repeatedly kill...   \n","31                   Pfft   that they don't have the type of expertise to...   \n","42                 Halo 1  .0 didn't solve the problem of \"good old fashi...   \n","52       Since you posted   it here, I'm sure the last time they ever tal...   \n","54               Again, I  'm sure the President can find a way to lay ou...   \n","55              I've seen   some of these guys with guns, not sure if the...   \n","56            It's better   to be a pussy than an asshole, right? *pfft* ...   \n","63         How exactly do   you have a job like that? *HURRY* I'm not the...   \n","79   Especially since you   don't have a dick in your mouth, and are just...   \n","82                 *alleg  edly, you're a good guy and shouldn't be oppre...   \n","90                 It's a   good thing he didn't get to let the guy have ...   \n","93                Protip:   they don't have any comments, so it's not rac...   \n","98      Any comment about   who was the bad guy? *cheerful* You know, I'm...   \n","104        Please tell me  , how could they possibly not want to talk abo...   \n","109    I was disappointed   they took the time to remind us. It's just no...   \n","114     Despite that fact  , it's not like he was a racist. We all know t...   \n","123         And then kill   them all and have a new era of peace for the ...   \n","131              A collie   at the top of my game and I'm going to have a...   \n","134           Is this the   tip of a iceberg? -_- I can tell you guys don...   \n","\n","                                   Fine-tuned with PPO  \n","0    ing out a bunch of guitars! Ignore the fact th...  \n","2     are the only ones in charge of that group.\\nT...  \n","3    ed to the wall!\\nInstallation by an angry mob....  \n","4     a lot of money out of our pension fund to buy...  \n","13    the country is doing well because our people ...  \n","15    about this happen. And they're all totally ha...  \n","18    that the Russians are trying to conquer Russi...  \n","31   , it's not like they are trying to make sure a...  \n","42   . What is wrong with the media? Come on, they ...  \n","52    this, they were totally cool! At least we can...  \n","54   'm sure the guys in charge of protecting girls...  \n","55    it. Heck, I'm sure they were just trying to b...  \n","56    when everyone knows they're supposed to be ra...  \n","63    we know that the US is a totally horrible cou...  \n","79    are so much smarter than me! Check out the pi...  \n","82   ations that all of the kids in those schools w...  \n","90    bad thing that they're supposed to be racist ...  \n","93   Yes, because it's totally okay to have a man h...  \n","98    a guy being an asshole is totally okay! But I...  \n","104   you didn't know that the only thing he can do...  \n","109   that the president didn't have a better idea....  \n","114  , it's possible to be completely insane. And t...  \n","123   people with guns and can all go back to the r...  \n","131  .\\n\\n\\nYeah, because we all know the Russian g...  \n","134   way it should be! Should we just have a baby?...  "],"text/html":["\n","  <div id=\"df-008cb875-8b0f-4c2a-a3d9-a50543bd4bd2\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Prompts</th>\n","      <th>Conventionally finetuned</th>\n","      <th>Fine-tuned with PPO</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Or, bust</td>\n","      <td>le and the rush of traffic can cause you to be...</td>\n","      <td>ing out a bunch of guitars! Ignore the fact th...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Women, homosexuals</td>\n","      <td>and the rest of us are just as bad. They're r...</td>\n","      <td>are the only ones in charge of that group.\\nT...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>The door weld</td>\n","      <td>s shut, so we should all be able to drink free...</td>\n","      <td>ed to the wall!\\nInstallation by an angry mob....</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>I'd take</td>\n","      <td>a lot of time to get that done, but I'm sure ...</td>\n","      <td>a lot of money out of our pension fund to buy...</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>And you believe</td>\n","      <td>this? It's because our government, the public...</td>\n","      <td>the country is doing well because our people ...</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Today I learned</td>\n","      <td>about the death penalty in high school and it...</td>\n","      <td>about this happen. And they're all totally ha...</td>\n","    </tr>\n","    <tr>\n","      <th>18</th>\n","      <td>The irony is</td>\n","      <td>that the Israeli military has repeatedly kill...</td>\n","      <td>that the Russians are trying to conquer Russi...</td>\n","    </tr>\n","    <tr>\n","      <th>31</th>\n","      <td>Pfft</td>\n","      <td>that they don't have the type of expertise to...</td>\n","      <td>, it's not like they are trying to make sure a...</td>\n","    </tr>\n","    <tr>\n","      <th>42</th>\n","      <td>Halo 1</td>\n","      <td>.0 didn't solve the problem of \"good old fashi...</td>\n","      <td>. What is wrong with the media? Come on, they ...</td>\n","    </tr>\n","    <tr>\n","      <th>52</th>\n","      <td>Since you posted</td>\n","      <td>it here, I'm sure the last time they ever tal...</td>\n","      <td>this, they were totally cool! At least we can...</td>\n","    </tr>\n","    <tr>\n","      <th>54</th>\n","      <td>Again, I</td>\n","      <td>'m sure the President can find a way to lay ou...</td>\n","      <td>'m sure the guys in charge of protecting girls...</td>\n","    </tr>\n","    <tr>\n","      <th>55</th>\n","      <td>I've seen</td>\n","      <td>some of these guys with guns, not sure if the...</td>\n","      <td>it. Heck, I'm sure they were just trying to b...</td>\n","    </tr>\n","    <tr>\n","      <th>56</th>\n","      <td>It's better</td>\n","      <td>to be a pussy than an asshole, right? *pfft* ...</td>\n","      <td>when everyone knows they're supposed to be ra...</td>\n","    </tr>\n","    <tr>\n","      <th>63</th>\n","      <td>How exactly do</td>\n","      <td>you have a job like that? *HURRY* I'm not the...</td>\n","      <td>we know that the US is a totally horrible cou...</td>\n","    </tr>\n","    <tr>\n","      <th>79</th>\n","      <td>Especially since you</td>\n","      <td>don't have a dick in your mouth, and are just...</td>\n","      <td>are so much smarter than me! Check out the pi...</td>\n","    </tr>\n","    <tr>\n","      <th>82</th>\n","      <td>*alleg</td>\n","      <td>edly, you're a good guy and shouldn't be oppre...</td>\n","      <td>ations that all of the kids in those schools w...</td>\n","    </tr>\n","    <tr>\n","      <th>90</th>\n","      <td>It's a</td>\n","      <td>good thing he didn't get to let the guy have ...</td>\n","      <td>bad thing that they're supposed to be racist ...</td>\n","    </tr>\n","    <tr>\n","      <th>93</th>\n","      <td>Protip:</td>\n","      <td>they don't have any comments, so it's not rac...</td>\n","      <td>Yes, because it's totally okay to have a man h...</td>\n","    </tr>\n","    <tr>\n","      <th>98</th>\n","      <td>Any comment about</td>\n","      <td>who was the bad guy? *cheerful* You know, I'm...</td>\n","      <td>a guy being an asshole is totally okay! But I...</td>\n","    </tr>\n","    <tr>\n","      <th>104</th>\n","      <td>Please tell me</td>\n","      <td>, how could they possibly not want to talk abo...</td>\n","      <td>you didn't know that the only thing he can do...</td>\n","    </tr>\n","    <tr>\n","      <th>109</th>\n","      <td>I was disappointed</td>\n","      <td>they took the time to remind us. It's just no...</td>\n","      <td>that the president didn't have a better idea....</td>\n","    </tr>\n","    <tr>\n","      <th>114</th>\n","      <td>Despite that fact</td>\n","      <td>, it's not like he was a racist. We all know t...</td>\n","      <td>, it's possible to be completely insane. And t...</td>\n","    </tr>\n","    <tr>\n","      <th>123</th>\n","      <td>And then kill</td>\n","      <td>them all and have a new era of peace for the ...</td>\n","      <td>people with guns and can all go back to the r...</td>\n","    </tr>\n","    <tr>\n","      <th>131</th>\n","      <td>A collie</td>\n","      <td>at the top of my game and I'm going to have a...</td>\n","      <td>.\\n\\n\\nYeah, because we all know the Russian g...</td>\n","    </tr>\n","    <tr>\n","      <th>134</th>\n","      <td>Is this the</td>\n","      <td>tip of a iceberg? -_- I can tell you guys don...</td>\n","      <td>way it should be! Should we just have a baby?...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-008cb875-8b0f-4c2a-a3d9-a50543bd4bd2')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-008cb875-8b0f-4c2a-a3d9-a50543bd4bd2 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-008cb875-8b0f-4c2a-a3d9-a50543bd4bd2');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":28}]},{"cell_type":"code","source":["import random\n","\n","#ID's for how texts were generated - conv = even numbers, ppo = odd\n","text1_ids = [\" \" + \"#\" + str(random.randrange(100, 1000, 2))for _ in range(num_prompts)]\n","text2_ids = [\" \" + \"#\" + str(random.randrange(101, 1000, 2)) for _ in range(num_prompts)]\n","\n","mturk_csv = filtered_df\n","mturk_csv['text1'] = [mturk_csv['Conventionally finetuned'].iloc[i] + text1_ids[i] for i in range(len(mturk_csv))]\n","mturk_csv['text2'] = [mturk_csv['Fine-tuned with PPO'].iloc[i] + text2_ids[i]  for i in range(len(mturk_csv))]\n","mturk_csv = mturk_csv.drop(['Conventionally finetuned', 'Fine-tuned with PPO'], axis = 1)\n","\n","#Randomly swap values between columns\n","for i in range(len(mturk_csv)):\n"," if random.random() < 0.5:\n","  mturk_csv.iloc[i, 1], mturk_csv.iloc[i, 2] = mturk_csv.iloc[i, 2], mturk_csv.iloc[i, 1]\n","\n","mturk_csv.to_csv('/content/drive/MyDrive/Colab Notebooks/results/Mturk_SARC.csv', encoding = 'utf-8', index=False)  "],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"J-soqoO5fcKp","executionInfo":{"status":"ok","timestamp":1651039762555,"user_tz":-120,"elapsed":16,"user":{"displayName":"Troels Jensen","userId":"10952173865704385677"}},"outputId":"d2fde93a-8fbc-4ccf-cde5-8f45ac0aa4ed"},"execution_count":30,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:8: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  \n","/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:9: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  if __name__ == '__main__':\n"]}]},{"cell_type":"code","source":[""],"metadata":{"id":"CmjbQQVKvrI4","executionInfo":{"status":"ok","timestamp":1651037300055,"user_tz":-120,"elapsed":7,"user":{"displayName":"Troels Jensen","userId":"10952173865704385677"}}},"execution_count":7,"outputs":[]}],"metadata":{"colab":{"name":"SARC_Inference_2.0","provenance":[{"file_id":"1yptMp6F915BhDRRSiB_Whn-osY4mIV8u","timestamp":1648454099405}],"collapsed_sections":[],"authorship_tag":"ABX9TyMsh0HH+QrvhoaqJfjQD+2u"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}